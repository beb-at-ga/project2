<% if (customer.firstname) { %>
<h2>Hi, <%= customer.firstname %></h2>
<% } else { %>
<h2>Hi, <%= customer.email %></h2>
<% } %>

<!-- <body onload="getLocation()"></body> -->
<div>
  <button onclick="getLocation()">Find Nearest</button>
</div>
<p id="location"></p>
<hr />

<label for="firstname">First Name</label>:
<input id="firstname" type="text" name="firstname" value="<%= customer.firstname %>" placeholder="First Name"
  form="profileform">

<div>
  <% if (watchedRoutes.routeCombos.length > 0) { %>
    <div>
      <p>Frequent Routes:</p>
      <ul>
        <% watchedRoutes.routeCombos.forEach(r => {  %>
        <li>
          <a href="/routes/<%= r.id %>/<%= r.departingTerminalId %>"><%= r.departingTerminalName %> to
            <%= r.arrivingTerminalName %></a>
        </li>
        <% }) %>
      </ul>
    </div>
    <% } %>
    
    <div>
      <form id="profileform" method="POST" action="/profile">

        <select id="preferredroute" name="preferredroute">
          <% routeMatrix.forEach(rm => { %>
          <% if (rm.routeId === customer.preferredrouteid) { %>
          <option
            value='{"id": <%= rm.id %>, "routeId": <%= rm.routeId %>, "scheduledRouteId": <%= rm.scheduledRouteId %>, "departingTerminalId": <%= rm.departingTerminalId %>, "arrivingTerminalId": <%= rm.arrivingTerminalId %>}'
            selected><%= `${rm.departingTerminalName} -> ${rm.arrivingTerminalName}` %></option>
          <% } else { %>
          <option
            value='{"id": <%= rm.id %>, "routeId": <%= rm.routeId %>, "scheduledRouteId": <%= rm.scheduledRouteId %>, "departingTerminalId": <%= rm.departingTerminalId %>, "arrivingTerminalId": <%= rm.arrivingTerminalId %>}'>
            <%= `${rm.departingTerminalName} -> ${rm.arrivingTerminalName}` %></option>
          <% } %>
          <% }) %>
        </select>

        <button type="submit">Save Frequently Used Route</button>
      </form>
    </div>


</div>


<hr />


<% if (watchedJourns.length > 0) { %>
  <p>Watched Journy Count: <%= watchedJourns.length %> </p>
  <div>
    <p>Currently Watched Journeys</p>
    <ul>
      <% watchedJourns.forEach(j => {  %>
      <li>
        <a href="#"><%= j.journyId %></a>
        </li>
      <% }) %>
    </ul>
  </div>
  <% } %>


<!-- 
<p>Best walking time from current location:</p>
<p id="best_time"></p>

 -->


<!-- 
<p>TODO: Add "method/walking, method/bicycling".</p>
<p>TODO: Add "buffer time".</p>
<p>TODO: Add schedule "tracking", an array of schedules to watch.</p>
<hr />
 -->


<!-- 
<div id='map'></div>
<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiYmViLSIsImEiOiJjanpsbGpuZjMwd2ttM2JrNmtyNTVldGM0In0.Tmu9yv3-2cWJFxiq87xFPQ';
  var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [-96, 37.8], // starting position
    zoom: 3 // starting zoom
  });

  // Add geolocate control to the map.
  map.addControl(new mapboxgl.GeolocateControl({
    positionOptions: {
      enableHighAccuracy: true
    },
    trackUserLocation: true
  }));
</script> -->